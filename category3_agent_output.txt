python3 standards_enhancement_demo.py --all

Running all test cases:

================================================================================
Running Standards Enhancement for: Digital Assets in Istisna'a (FAS 10)
================================================================================
Starting enhancement process for FAS 10...
Trigger scenario: A financial institution wants to structure an Istisna'a contract for the development 
                              of a large-scale AI software platform. The current wording of FAS 10 on 'well-defined 
                              subject matter' and 'determination of cost' is causing uncertainty for intangible assets 
                              like software development.

Step 1: Reviewing standard and identifying enhancement areas...

Step 2: Generating enhancement proposals...

Step 3: Validating enhancement proposals...

# Standards Enhancement Results for FAS 10

## Trigger Scenario
A financial institution wants to structure an Istisna'a contract for the development 
                              of a large-scale AI software platform. The current wording of FAS 10 on 'well-defined 
                              subject matter' and 'determination of cost' is causing uncertainty for intangible assets 
                              like software development.

## Review Findings
Okay, here is a review of AAOIFI Shari'ah Standard No. (11) on Istisna'a and Parallel Istisna'a (referred to as FAS 10 in the prompt's context, although the provided text is SS 11) based on the trigger scenario involving a large-scale AI software platform development.

The trigger scenario highlights challenges in applying the traditional Istisna'a framework, designed primarily for tangible manufacturing and construction, to intangible and complex deliverables like AI software. Specifically, the issues are the requirement for a "well-defined subject matter" and the "determination of cost" (which translates to the price needing to be known).

Here are the sections from the provided text that may need enhancement in light of this scenario:

**1. Specific Section/Clause:** Shari’ah Standard No. (11), Section **3/1/1** and its underlying basis (from the Appendices, although not explicitly provided, the concept is implied by the definition).

*   **Text:** "An Istisna’a contract is permissible only for raw materials that can be transformed from their natural state by a manufacturing or construction process involving labour. Therefore, Istisna’a is valid only in so far as the supplier has agreed to provide a subject-matter that is manufactured or constructed."
*   **Potential Gap or Ambiguity:** This clause, and the traditional understanding of Istisna'a, is heavily rooted in the transformation of *tangible* raw materials into a physical product or structure. The language "raw materials," "natural state," "manufacturing or construction process" points towards physical goods.
*   **Why this is an issue in the context of the trigger scenario:** A large-scale AI software platform is a purely intangible asset. Its "raw materials" are concepts, code, data, algorithms, existing libraries, and human intellectual effort. The "manufacturing process" involves coding, design, testing, integration, and deployment – processes fundamentally different from physical manufacturing or construction. The standard does not explicitly define how these terms apply to or can encompass intangible creations. This creates ambiguity on whether software development, particularly complex AI, truly fits the definition of Istisna'a as defined here.

**2. Specific Section/Clause:** Shari’ah Standard No. (11), Section **2/2/1** and **3/1/2**.

*   **Text:**
    *   2/2/1: "A contract of Istisna’a is binding on the contracting parties provided that certain conditions are fulfilled, which include specification of the type, kind, quality and quantity of the subject-matter to be produced. Moreover, the price of the subject-matter must be known..."
    *   3/1/2: "It is permissible that a contract of Istisna’a be concluded for the production of a subject-matter having unique descriptions... provided the subject-matter is subject to specification. Similarly, it is permissible that the subject-matter... be items that have perfect substitutes... because they share common characteristics by virtue of the process of manufacture or construction. This rule applies whether the items to be produced are intended for consumption or for use with their substance kept intact."
*   **Potential Gap or Ambiguity:** While Section 3/1/2 allows for unique descriptions and 2/2/1 requires specification of "type, kind, quality and quantity," the application of "quantity" and precise "specification" to complex, bespoke software development is challenging. Software, especially large-scale AI, often involves iterative development (like agile methodologies) where the exact final feature set, performance metrics ("quality"), and even scope ("quantity" in terms of modules or functionalities) may evolve during the project based on testing, data, and emergent requirements. Specifying these elements definitively at the *outset* of a large AI project, as implied by "at the time of contracting" and "binding," is often difficult and impractical.
*   **Why this is an issue in the context of the trigger scenario:** AI software development is inherently complex and often involves R&D elements. It's hard to provide a perfectly fixed specification ("type, kind, quality, quantity") upfront without building in significant contingencies or limiting innovation. The standard's requirement for precise initial specification, while suitable for manufacturing standard goods or constructing a defined building, may not align with modern software development practices where flexibility and iterative refinement are key. This could make structuring AI projects under a strict Istisna'a framework cumbersome or risky for both parties.

**3. Specific Section/Clause:** Shari’ah Standard No. (11), Section **3/2/1** and **3/2/5**.

*   **Text:**
    *   3/2/1: "It is a requirement that the price for an Istisna’a contract be known at the conclusion of the contract..."
    *   3/2/5: "A contract of Istisna’a cannot be drawn up on the basis of a Murabahah sale, for example, by determining the price of Istisna’a on a cost- plus basis."
*   **Potential Gap or Ambiguity:** These clauses mandate a known, agreed-upon price *at the outset* and explicitly prohibit cost-plus pricing.
*   **Why this is an issue in the context of the trigger scenario:** Software development costs, especially for complex, large-scale AI platforms, are notoriously difficult to estimate accurately upfront. They depend heavily on factors like developer productivity, unforeseen technical challenges, data availability and quality, and evolving requirements. Pricing models in the software industry often involve time-and-materials (akin to cost-plus), phased payments linked to milestones (allowed by 3/2/2, but still assuming an overall known price), or hybrid models that aren't strictly fixed-price. The strict requirement for a known price (3/2/1) combined with the prohibition of cost-plus (3/2/5) can make it difficult to structure an Istisna'a contract that reflects the inherent cost uncertainty of large-scale, bespoke software development, potentially pushing parties towards less suitable Shari'ah contracts or conventional financing. While 4/1/1 allows price adjustments for *amendments*, the initial price determination remains a hurdle.

**Summary of Potential Enhancements:**

The standard's language and core principles appear tailored for tangible assets. To effectively apply Istisna'a to intangible assets like software, the standard could benefit from:

1.  **Clarifying Scope (3/1/1):** Explicitly address whether and how intangible assets like software fit the definition of 'subject-matter' and how the concept of 'transformation' applies in a non-physical context.
2.  **Guidance on Specification (2/2/1, 3/1/2):** Provide guidance on how to specify "type, kind, quality, and quantity" for intangible, complex, and potentially iterative deliverables like software, acknowledging the realities of modern development methodologies.
3.  **Flexibility in Pricing (3/2/1, 3/2/5):** Explore and permit Shari'ah-compliant pricing mechanisms that accommodate the inherent cost uncertainty in complex intangible development, potentially offering alternatives to a strictly fixed price model or clarifying permissible variable elements that stop short of prohibited cost-plus structures or *Inah.

These enhancements would help Islamic financial institutions and customers confidently and appropriately use the Istisna'a contract for financing modern technological development projects, including AI software platforms.

## Proposed Enhancements
Okay, here are proposed enhancements to AAOIFI Shari’ah Standard No. (11) on Istisna’a and Parallel Istisna’a (SS 11), based on the reviewer's analysis and the trigger scenario involving AI software development.

These proposals aim to clarify the application of Istisna'a to intangible assets and complex projects, addressing the ambiguities identified regarding subject matter definition and price determination, while remaining consistent with Shari'ah principles.

---

**Enhancement Proposal 1: Clarifying the Scope and Nature of the Subject Matter (3/1/1)**

*   **Issue:** The current wording focuses heavily on tangible transformation of physical raw materials, creating ambiguity for intangible assets like software.
*   **Original Text (3/1/1):**
    > 3/1/1 An Istisna’a contract is permissible only for raw materials that can be transformed from their natural state by a manufacturing or construction process involving labour. Therefore, Istisna’a is valid only in so far as the supplier has agreed to provide a subject-matter that is manufactured or constructed.
*   **Proposed Modified Text (3/1/1):**
    > 3/1/1 An Istisna’a contract is permissible for the creation of a subject-matter resulting from a process of transformation involving labour, whether this transformation is of tangible raw materials through manufacturing or construction, or the creation of intangible works from data, code, intellectual effort, or other inputs. Therefore, Istisna’a is valid only in so far as the supplier has agreed to provide a subject-matter that is manufactured, constructed, or created through a similar process of transformation.
*   **Rationale:** This modification explicitly broadens the scope of Istisna'a to include the creation of intangible assets. It reframes "transformation" to encompass the intellectual and digital processes involved in creating software, designs, or other non-physical outputs, alongside traditional manufacturing and construction. This aligns the standard with modern economic activities while maintaining the core Istisna'a principle of creating something new through effort and transformation.
*   **How it Addresses the Trigger Scenario:** This change directly addresses the ambiguity regarding whether AI software development (a purely intangible asset creation) falls under the permissible subject matter for Istisna'a, confirming that such projects can, in principle, be structured as Istisna'a.

---

**Enhancement Proposal 2: Providing Guidance on Specification for Complex/Intangible Subject Matter (2/2/1 & 3/1/2)**

*   **Issue:** The requirement for precise specification ("type, kind, quality and quantity") at the outset is challenging for complex, iterative projects like large-scale AI software development where details may evolve.
*   **Original Text (Relevant parts of 2/2/1 & 3/1/2):**
    > 2/2/1 A contract of Istisna’a is binding on the contracting parties provided that certain conditions are fulfilled, which include specification of the type, kind, quality and quantity of the subject-matter to be produced. Moreover, the price of the subject-matter must be known and, if necessary, the delivery date must be determined. If the subject-matter does not conform to the specification agreed upon, the customer has the option to accept or to refuse the subject-matter.
    >
    > 3/1/2 It is permissible that a contract of Istisna’a be concluded for the production of a subject-matter having unique descriptions according to the requirement of the ultimate purchaser even if such a subject-matter has no substitutes in the market, provided the subject-matter is subject to specification. Similarly, it is permissible that the subject-matter of a contract of Istisna’a be items that have perfect substitutes in the market, and can be substituted for one another in fulfilling an obligation, because they share common characteristics by virtue of the process of manufacture or construction. This rule applies whether the items to be produced are intended for consumption or for use with their substance kept intact.
*   **Proposed Modified Text (Combine and clarify):**
    *   Modify 2/2/1:
        > 2/2/1 A contract of Istisna’a is binding on the contracting parties provided that certain conditions are fulfilled, which include sufficient specification of the type, kind, quality and quantity of the subject-matter to be produced to eliminate material uncertainty (*Jahalah*) that could lead to dispute. For complex or intangible subject-matter, this specification may include functional requirements, performance criteria, architectural descriptions, and defined development milestones or phases. While detailed specifications may be elaborated during the project lifecycle, the foundational characteristics and parameters must be clearly defined at the time of contracting. Moreover, the price of the subject-matter must be known and, if necessary, the delivery date must be determined. If the subject-matter does not conform to the specification agreed upon, the customer has the option to accept or to refuse the subject-matter.
    *   Modify 3/1/2 (minor addition for consistency with 2/2/1):
        > 3/1/2 It is permissible that a contract of Istisna’a be concluded for the production of a subject-matter having unique descriptions according to the requirement of the ultimate purchaser even if such a subject-matter has no substitutes in the market, provided the subject-matter is subject to sufficient specification as outlined in 2/2/1. Similarly, it is permissible that the subject-matter of a contract of Istisna’a be items that have perfect substitutes in the market, and can be substituted for one another in fulfilling an obligation, because they share common characteristics by virtue of the process of manufacture or construction or creation. This rule applies whether the items to be produced are intended for consumption or for use with their substance kept intact.
*   **Rationale:** This enhancement acknowledges the reality of complex project development, particularly for software. It clarifies that "specification" can take forms relevant to intangible assets (functional requirements, performance criteria, etc.) and explicitly permits the elaboration of detailed specifications during the project, provided the core definition is clear at the outset to avoid *Jahalah*. This aligns with the Shari'ah principle of avoiding excessive uncertainty while offering practical flexibility for modern projects.
*   **How it Addresses the Trigger Scenario:** This addresses the difficulty of providing a completely fixed and exhaustive specification for a large AI platform upfront. It allows for the use of methods like defining key features, performance benchmarks, and development phases as the basis for specification, which is common in software development, making the Istisna'a framework more adaptable.

---

**Enhancement Proposal 3: Clarifying Pricing Mechanisms for Projects with Cost Uncertainty (3/2/1 & 3/2/5)**

*   **Issue:** The strict requirement for a known price at the outset and the prohibition of cost-plus pricing are challenging for complex, bespoke intangible projects like AI development where costs are inherently uncertain.
*   **Original Text (Relevant parts of 3/2/1 & 3/2/5):**
    > 3/2/1 It is a requirement that the price for an Istisna’a contract be known at the conclusion of the contract, in which case it can be in the form of cash or tangible goods or the usufruct of an asset for a particular duration, whether such usufruct is related to an asset other than the subject-matter or to the subject-matter itself. The use of usufruct of the subject-matter itself as consideration for an Istisna’a contract is relevant to situations when a government offers a preferential contract giving usufruct to the builder or manufacturer for a particular duration, commonly known as Build Operate Transfer (BOT).
    >
    > 3/2/5 A contract of Istisna’a cannot be drawn up on the basis of a Murabahah sale, for example, by determining the price of Istisna’a on a cost- plus basis.
*   **Proposed Modified Text (Combine and clarify):**
    *   Modify 3/2/1:
        > 3/2/1 It is a requirement that the price for an Istisna’a contract be known at the conclusion of the contract or determined by a clearly defined, objective mechanism agreed upon at the time of contracting, in which case it can be in the form of cash or tangible goods or the usufruct of an asset for a particular duration, whether such usufruct is related to an asset other than the subject-matter or to the subject-matter itself. For complex projects with inherent cost uncertainty, the 'known price' requirement may be satisfied by: (a) a fixed price; (b) a capped price (maximum price); or (c) a price determined based on the completion of defined stages or milestones, where the price for each stage is known or determinable by a pre-agreed objective mechanism linked to the deliverables of that stage. The use of usufruct of the subject-matter itself as consideration for an Istisna’a contract is relevant to situations when a government offers a preferential contract giving usufruct to the builder or manufacturer for a particular duration, commonly known as Build Operate Transfer (BOT).
    *   Modify 3/2/5:
        > 3/2/5 A contract of Istisna’a cannot be drawn up on the basis of a pure cost-plus arrangement where the final price is solely determined by adding a profit margin to the actual, unverified costs incurred by the manufacturer, as this introduces material uncertainty (*Jahalah*) and may resemble prohibited interest-based financing or *Bay' al-'Inah*. However, this does not preclude pricing mechanisms permitted under 3/2/1 that link payment to defined stages of completion or use a capped price, provided the overall pricing framework eliminates material uncertainty at the time of contracting.
*   **Rationale:** This enhancement provides practical Shari'ah-compliant options for pricing complex projects where upfront cost estimation is difficult. It explicitly permits capped prices and staged payments linked to defined deliverables/milestones, which are common and necessary in software development. It clarifies that while pure, open-ended cost-plus is prohibited due to uncertainty and potential resemblance to Riba/Inah, mechanisms that provide a clear framework for price determination based on agreed outcomes or limits are permissible. This upholds the principle of avoiding *Jahalah* in the price while offering necessary flexibility.
*   **How it Addresses the Trigger Scenario:** This directly addresses the challenge of pricing a large-scale AI software project with inherent cost uncertainty. It allows institutions to structure Istisna'a contracts using capped prices or milestone-based pricing, which are more suitable models for managing the financial risks and realities of such complex development projects than a rigid fixed-price model.

---

## Validation Results
Okay, acting as the Standards Validator Agent for AAOIFI, I will evaluate the proposed enhancements to SS 11 (Istisna'a and Parallel Istisna'a) based on the provided criteria and Shariah principles.

**Validation Assessment:**

**1. Enhancement Proposal 1: Clarifying the Scope and Nature of the Subject Matter (3/1/1)**

*   **Shariah Compliance Assessment:**
    *   **Principle:** Istisna'a is a contract for the creation of a specified product through manufacturing or construction. The core requirement is the transformation of inputs into a defined output.
    *   **Evaluation:** The original wording is narrow, focusing on *tangible* raw materials. The proposed modification broadens the concept of "transformation" to include the creation of *intangible* works from data, code, and intellectual effort. This aligns with the underlying Shariah principle that Istisna'a is for creating something new through effort, regardless of the tangibility of the raw materials or the final output, as long as the output can be clearly specified and delivered. It does not violate prohibitions of Riba, Gharar (addressed by specification), or Maysir. It maintains the asset-backed nature by focusing on the *created product* (the software) as the subject matter.
    *   **Conclusion:** Complies with core Shariah principles by extending the concept of 'creation through transformation' to intangible assets, which is a valid interpretation given the nature of modern outputs like software.

*   **Consistency Check:**
    *   **Internal Consistency (SS 11):** This enhancement provides a necessary foundation for applying other rules of SS 11 (specification, delivery, pricing) to intangible assets. It doesn't contradict the *mechanism* of Istisna'a, only expands the *type* of subject matter it can apply to.
    *   **Alignment with Related Standards:** The provided list of standards (on Set-Off, Insolvency, Commercial Papers, Agency, Documentary Credit, Indices, Contingent Incidents, Mudarabah, Profit Calculation, Credit Cards, Combination of Contracts, Investment Agency, Salam, Concession, Financial Rights, Mortgage, Waqf, Investment Accounts, Sukuk, Possession) does not contain any specific standard that would be directly contradicted by allowing Istisna'a for intangible assets. SS 11 is the primary standard governing Istisna'a.
    *   **Conclusion:** Consistent with the internal structure of SS 11 and does not conflict with other listed standards.

*   **Practical Implementation Assessment:**
    *   **Evaluation:** This enhancement is highly practical. It explicitly provides the Shariah basis for using Istisna'a for significant modern economic activities like software development, which was previously ambiguous under a strict interpretation of "raw materials." This allows Islamic financial institutions to finance such projects using a suitable contract type.
    *   **Conclusion:** Highly practical and addresses a significant market need.

*   **Decision for Enhancement 1:** **APPROVED**

**2. Enhancement Proposal 2: Providing Guidance on Specification for Complex/Intangible Subject Matter (2/2/1 & 3/1/2)**

*   **Shariah Compliance Assessment:**
    *   **Principle:** Contracts must be free from material uncertainty (*Jahalah*) that could lead to disputes. For Istisna'a, the subject matter must be sufficiently specified.
    *   **Evaluation:** The proposed modification clarifies that "sufficient specification" for complex/intangible assets can include functional, performance, and architectural criteria, and allows for the elaboration of detailed specifications during the project lifecycle, provided the foundational characteristics are clear *at the time of contracting*. This directly addresses the challenge of precisely defining complex outputs like software upfront. It maintains the core principle of avoiding *material* *Jahalah* by requiring a clear understanding of the *essence* and *key parameters* of the subject matter at contract inception, while acknowledging the iterative nature of such projects. This is a valid interpretation of the *Jahalah* principle, focusing on preventing likely disputes rather than demanding impossible absolute certainty from day one for bespoke creations.
    *   **Conclusion:** Complies with core Shariah principles by adapting the requirement of specification to the nature of complex and intangible subject matter while upholding the prohibition of material *Jahalah*.

*   **Consistency Check:**
    *   **Internal Consistency (SS 11):** This enhancement clarifies *how* the existing requirement of specification applies to a broader scope (Enhancement 1). It makes the standard more adaptable without changing the fundamental need for clarity regarding the contracted item.
    *   **Alignment with Related Standards:** No direct conflict with other listed standards.
    *   **Conclusion:** Consistent with the internal structure of SS 11 and other standards.

*   **Practical Implementation Assessment:**
    *   **Evaluation:** This is essential for practical implementation, especially for software development. Defining projects by functional requirements, performance benchmarks, and milestones is standard practice. A requirement for absolute, unchangeable detailed specifications upfront would render Istisna'a impractical for most bespoke software projects. This enhancement makes the standard usable for these scenarios.
    *   **Conclusion:** Highly practical and necessary for applying Istisna'a to modern complex projects.

*   **Decision for Enhancement 2:** **APPROVED**

**3. Enhancement Proposal 3: Clarifying Pricing Mechanisms for Projects with Cost Uncertainty (3/2/1 & 3/2/5)**

*   **Shariah Compliance Assessment:**
    *   **Principle:** The price in Istisna'a must be known at the time of contracting to avoid *Gharar* (uncertainty) and resemblance to Riba (in the case of pure cost-plus).
    *   **Evaluation:** The proposed modification allows the price to be known *or* determined by a "clearly defined, objective mechanism agreed upon at the time of contracting." It explicitly permits capped prices and stage/milestone-based pricing where each stage's price is known or determinable by a pre-agreed mechanism.
        *   *Capped Price:* The maximum price is known, eliminating significant *Gharar* for the buyer regarding their maximum liability.
        *   *Stage/Milestone Pricing:* The project is broken into defined, deliverable stages, each with a known or determinable price. While the *total* price might not be fixed if stages can be added or modified, the price for *each agreed unit of work* is clear when contracted, thus avoiding *material* *Gharar* for that unit. This is analogous to construction contracts where payment is tied to completion of defined phases (foundation, walls, roof).
        *   *Cost-Plus Clarification:* The modification to 3/2/5 correctly distinguishes between prohibited *pure*, open-ended cost-plus (which introduces *Jahalah* and potential Riba/Inah issues) and structured mechanisms like capped price or milestone payments, which provide price clarity or limits. This aligns with the Shariah rationale behind the prohibition.
    *   **Conclusion:** Complies with core Shariah principles by providing Shariah-compliant methods for determining price in complex projects that eliminate material *Gharar* at the point of contracting for the relevant scope, while upholding the prohibition of uncertain or pure cost-plus arrangements.

*   **Consistency Check:**
    *   **Internal Consistency (SS 11):** This enhancement clarifies *how* the existing requirement of a "known price" can be met in the context of complex projects and intangible assets. It provides practical alternatives that are consistent with the underlying principle of price clarity.
    *   **Alignment with Related Standards:** No direct conflict with other listed standards.
    *   **Conclusion:** Consistent with the internal structure of SS 11 and other standards.

*   **Practical Implementation Assessment:**
    *   **Evaluation:** This enhancement is crucial for practical implementation. Fixed-price contracts are often unsuitable for complex, bespoke software development due to inherent uncertainties. Capped prices and milestone-based payments are standard and necessary practices in the industry. This makes Istisna'a a viable and competitive option for financing such projects.
    *   **Conclusion:** Highly practical and essential for applying Istisna'a to modern complex projects.

*   **Decision for Enhancement 3:** **APPROVED**

**Overall Assessment:**

All three proposed enhancements address key ambiguities in applying SS 11 to modern intangible assets like software development. They do so by clarifying the scope, specification requirements, and pricing mechanisms in a manner that is consistent with the fundamental Shariah principles governing Istisna'a (primarily the avoidance of *Jahalah* in the subject matter and price) while making the standard practical for contemporary financial transactions. The proposed wording is clear and provides necessary guidance.

**Final Decision:**

Based on the validation checks, all three proposed enhancements are compliant with Shariah principles, maintain consistency with the standard, and are practical for implementation.

**APPROVED.**

**Detailed Reasoning:**

The enhancements collectively provide a robust framework for applying the Istisna'a contract to the creation of intangible assets, specifically addressing the challenges posed by projects like large-scale AI software development.

1.  **Scope (Enhancement 1):** Explicitly allows intangible assets as subject matter, recognizing that "transformation through labour" can result in non-physical outputs like software. This broadens the applicability of SS 11 appropriately for the digital age.
2.  **Specification (Enhancement 2):** Provides practical guidance on how to specify complex/intangible assets using modern project management concepts (functional requirements, milestones) while ensuring *material* uncertainty (*Jahalah*) is eliminated at the contract's outset. This respects the Shariah principle of clarity without imposing an impossible standard of absolute upfront detail.
3.  **Pricing (Enhancement 3):** Offers Shariah-compliant alternatives to a rigid fixed price for projects with inherent cost uncertainty (capped price, milestone-based payments). It correctly clarifies the prohibition of pure cost-plus by linking it to the Shariah rationale of avoiding *Jahalah* and resemblance to Riba/Inah, while permitting structured pricing mechanisms that provide necessary certainty or limits.

These changes collectively remove significant barriers to using Istisna'a for financing technological development, aligning Islamic finance practices with the needs of the modern economy while preserving Shariah integrity.